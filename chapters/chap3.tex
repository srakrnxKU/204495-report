\section{การวิเคราะห์และออกแบบขั้นตอนวิธี}

โครงงานวิศวกรรมคอมพิวเตอร์ชิ้นนี้มุ่งเสนอแนวคิดสำหรับการวิเคราะห์คลัสเตอร์เพื่อโจมตีแบบจำลองและใช้การโจมตีนั้นในการสอนแบบจำลองให้ทนทานต่อการโจมตี โดยตั้งอยู่บนแนวติดและสมมติฐานต่อไปนี้

\subsection{พฤติกรรมของคลัสเตอร์สัญญาณรบกวน}

หนึ่งในปัญหาของขั้นตอนวิธีเสริมความแข็งแกร่งแบบจำลอง คือการสร้างชุดสัญญาณรบกวนเพื่อฝึกสอนนั้นกินเวลานาน แม้จะมีขั้นตอนวิธีที่คำนวนได้อย่างรวดเร็วเช่นขั้นตอนวิธี FGSM แต่ขั้นตอนวิธีที่ใช้เวลาคิดคำนวนเร็วไม่สามารถสร้างสัญญาณรบกวนที่มีประสิทธิภาพในการโจมตีแบบจำลอง และสัญญาณรบกวนดังกล่าวไม่สามารถใช้ฝึกสอนแบบจำลองให้ทนทานต่อการโจมตีได้ \cite{aleks2017deep}

เพื่อลดปัญหาดังกล่าว โครงงานชิ้นนี้มุ่งเสนอแนวคิดว่า

\begin{claim}
    \label{in-cluster-attack}
    เมื่อให้ชุดข้อมูลประสงค์ร้าย $X'$ ที่โจมตีชุดข้อมูล $X$ พฤติกรรมของสัญญาณรบกวน $\eta$ สามารถจัดเป็นกลุ่มย่อยๆ ได้ และการโจมตีในสมาชิกของกลุ่มย่อยสามารถเกิดขึ้นได้ด้วยชุดสัญญาณโจมตีอื่นๆ ในจุดกลุ่มนั้น
\end{claim}

\begin{claim}
    \label{slow-fast-same}
    ผลการจัดกลุ่มคลัสเตอร์สัญญาณรบกวน ไม่ว่าจะบนสัญญาณรบกวนที่ได้มาจากวิธีการใด จะมีสมาชิกของแต่ละคลัสเตอร์ใกล้เคียงกัน
\end{claim}

ด้วยข้อสมมติฐานที่ \ref{slow-fast-same} เราสามารถสร้างสัญญาณรบกวนด้วยขั้นตอนวิธีที่เร็วเพื่อสร้างคลัสเตอร์ของสัญญาณรบกวนได้ เมื่อประกอบกับข้อสมมติฐานที่ \ref{in-cluster-attack} เราสามารถใช้ความรู้ของคลัสเตอร์มาช่วยร่นเวลาในการโจมตีแบบจำลองได้

ขั้นตอนวิธี \ref{cluster-gen} เสนอการคลัสเตอร์ข้อมูล และพยายามสร้างสัญญาณโจมตีด้วยขั้นตอนวิธีที่แม่นยำเพียงหนึ่งสัญญาณต่อคลัสเตอร์  กล่าวคือขั้นตอนวิธีดังกล่าวเรียกใช้ฟังก์ชันสำหรับสร้างสัญญาณรบกวนที่รวดเร็วเพียงเพื่อจัดกลุ่มของสัญญาณรบกวน ก่อนจะทำการโจมตีอย่างแม่นยำด้วยขั้นตอนวิธีที่แม่นยำ (แต่ไม่มีประสิทธิภาพทางด้านเวลา) ต่อไป

\begin{algorithm} 
    \caption{ขั้นตอนวิธีสร้างสัญญาณรบกวนจากคลัสเตอร์}
    \label{cluster-gen}
    \begin{algorithmic}
        \REQUIRE $M$ เป็นแบบจำลองการเรียนรู้
        \REQUIRE $X$ เป็นชุดข้อมูลที่จะทำการโจมตี
        \REQUIRE $k$ เป็นจำนวนคลัสเตอร์
        \REQUIRE $f_s$ เป็นฟังก์ชันสร้างสัญญาณรบกวนที่รวดเร็ว
        \REQUIRE $f_e$ เป็นฟังก์ชันสร้างสัญญาณรบกวนที่มีประสิทธิภาพ
        \STATE สร้างชุดสัญญาณรบกวน $P_s$ ที่โจมตีแบบจำลอง $M$ บนชุดข้อมูล $X$ ด้วยขั้นตอนวิธี $f_s$
        \STATE วิเคราะห์คลัสเตอร์ด้วยขั้นตอนวิธี $k$-มีนส์ บน $P_s$ ด้วยจำนวนคลัสเตอร์ $k$ คลัสเตอร์
        \FOR{ทุกคลัสเตอร์ $c_i \in C$}
            \STATE สร้างสัญญาณรบกวน $p_i$ ที่มีความสามารถโจมตีทุกจุด $c_i$ บนแบบจำลอง $M$ ด้วยขั้นตอนวิธี $f_e$
            \STATE เก็บสัญญาณรบกวน $p_i$ และเซต $C_i$ ซึ่งมีสมาชิก $c_i$ ทุกตัวในคลัสเตอร์ $C$
        \ENDFOR
        \RETURN ค่า $p_i$ และ $c_i$ สำหรับทุก $i = 1$ ถึง $k$
    \end{algorithmic}
\end{algorithm}

\subsection{การเสริมความแข็งแกร่งด้วยวิธีการผสานคลัสเตอร์}

จากขั้นตอนวิธี \ref{cluster-gen} เราสามารถนำชุดสัญญาณโจมตีมาฝึกสอนแบบจำลองเพื่อเสริมความแข็งแกร่งได้ ดังแสดงในขั้นตอนวิธี \ref{cluster-retrain}

\begin{algorithm} 
    \caption{การเสริมความแข็งแกร่งด้วยวิธีการผสานคลัสเตอร์}
    \label{cluster-retrain}
    \begin{algorithmic}
        \REQUIRE $M$ เป็นแบบจำลองการเรียนรู้
        \REQUIRE $X$ เป็นชุดข้อมูลที่จะทำการโจมตี
        \REQUIRE $e$ เป็นจำนวนรอบการวนซ้ำ (epoches) ในการฝึกสอน
        \REQUIRE $m$ และ $n$ เป็นขนาดของชุดฝึกสอนเล็กจิ๋ว (minibatch) บนชุดข้อมูลต้นฉบับและชุดข้อมูลประสงค์ร้าย
        \REQUIRE $w$ และ $w'$ เป็นน้ำหนักของชุดฝึกสอนเล็กจิ๋ว (minibatch) บนชุดข้อมูลต้นฉบับและชุดข้อมูลประสงค์ร้าย
        \STATE สร้างสัญญาณรบกวนจากคลัสเตอร์ ที่โจมตีข้อมูล $X$ บนแบบจำลอง $M$ โดยใช้ขั้นตอนวิธี \ref{cluster-gen}.
        \FOR{$i=1$ ถึง $e$}
            \STATE สร้างชุดฝึกสอนจิ๋วบนชุดข้อมูลต้นฉบับ $B=\{x_1, x_2, \dots, x_m\}$.
            \STATE สร้างชุดฝึกสอนจิ๋วบนชุดข้อมูลประสงค์ร้าย $B'=\{x_1', x_2', \dots, x_n'\}$.
            \STATE ฝึกสอนแบบจำลองแบบถ่วงน้ำหนัก โดยให้น้ำหนัก $w$ บน $B$ และ $w'$ บน $B'$.
        \ENDFOR
        \RETURN แบบจำลอง $M$
    \end{algorithmic}
\end{algorithm}

\section{การทดลองวัดประสิทธิภาพ}

นอกจากการเสนอขั้นตอนวิธีแล้ว ผู้จัดทำมุ่งความสนใจไปยังวิธีการวัดประสิทธิภาพของขั้นตอนวิธีด้วยเช่นกัน

ผู้จัดทำโครงงานจัดทำชุดคำสั่งสำหรับขั้นตอนวิธีที่เสนอในโครงงานวิศวกรรมชิ้นนี้ บนไลบรารี (library) การเรียนรู้เชิงลึก PyTorch \cite{PyTorch2019}

ชุดคำสั่งทั้งหมดสามารถเข้าถึงออนไลน์ได้ผ่านระบบควบคุมเวอร์ชัน (Software Version Control) GitHub ผ่านทาง \url{https://github.com/srakrnxKU/adversarial-project/}
